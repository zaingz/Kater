/*! Nestoria Slider - v1.0.10 - 2015-04-09
* http://lokku.github.io/jquery-nstslider/
* Copyright (c) 2015 Lokku Ltd.; Licensed MIT */
!function(t){var a,e,r,i,n,l,_,o,d={getSliderValuesAtPositionPx:function(t,a){var e,r,i=this,n=i.data("pixel_to_value_mapping");if("undefined"!=typeof n)e=n(t),r=n(a);else{var l=d.getSliderWidthPx.call(i)-i.data("left_grip_width");e=d.inverse_rangemap_0_to_n.call(i,t,l),r=d.inverse_rangemap_0_to_n.call(i,a,l)}return[e,r]},validateAndMoveGripsToPx:function(t,a){var e=this,r=d.getSliderWidthPx.call(e)-e.data("left_grip_width");if(r>=a&&t>=0&&r>=t&&(!e.data("has_right_grip")||a>=t)){var i=e.data("cur_min"),n=e.data("cur_max");d.set_position_from_px.call(e,t,a),d.refresh_grips_style.call(e),d.notify_changed_implicit.call(e,"drag_move",i,n)}return e},updateAriaAttributes:function(){var t=this,a=t.data("settings"),e=t.find(a.left_grip_selector);if(t.data("has_right_grip")){var r=t.find(a.right_grip_selector);e.attr("aria-valuemin",t.data("range_min")).attr("aria-valuenow",s.get_current_min_value.call(t)).attr("aria-valuemax",s.get_current_max_value.call(t)),r.attr("aria-valuemin",s.get_current_min_value.call(t)).attr("aria-valuenow",s.get_current_max_value.call(t)).attr("aria-valuemax",t.data("range_max"))}else e.attr("aria-valuemin",t.data("range_min")).attr("aria-valuenow",s.get_current_min_value.call(t)).attr("aria-valuemax",t.data("range_max"));return t},getSliderWidthPx:function(){var t=this;return Math.round(t.width())},getGripPositionPx:function(t){return parseInt(t.css("left").replace("px",""),10)},getLeftGripPositionPx:function(){var t=this,a=t.data("settings"),e=t.find(a.left_grip_selector);return d.getGripPositionPx.call(t,e)},getRightGripPositionPx:function(){var t=this,a=t.data("settings");if(t.data("has_right_grip"))return d.getGripPositionPx.call(t,t.find(a.right_grip_selector));var e=d.getSliderWidthPx.call(t)-t.data("left_grip_width");return d.rangemap_0_to_n.call(t,t.data("cur_max"),e)},getLeftGripWidth:function(){var t=this,a=t.data("settings"),e=t.find(a.left_grip_selector);return Math.round(e.outerWidth())},getRightGripWidth:function(){var t=this,a=t.data("settings"),e=t.find(a.right_grip_selector);return Math.round(e.outerWidth())},binarySearchValueToPxCompareFunc:function(a,e,r){return a===e[r]?0:a<e[r]&&0===r?0:e[r-1]<=a&&a<e[r]?0:a>e[r]?1:a<=e[r-1]?-1:void t.error("cannot compare s: "+a+" with a["+r+"]. a is: "+e.join(","))},binarySearch:function(t,a,e,r){for(var i,n,l=0,_=t.length-1;_>=l;){i=(l+_)/2|0,n=e(t,i);var o=r(a,t,i);if(o>0)l=i+1;else{if(!(0>o))return i;_=i-1}}return-1},haveLimits:function(){var t=this,a=t.data("lower-limit"),e=t.data("upper-limit"),r=!1;return"undefined"!=typeof a&&"undefined"!=typeof e&&(r=!0),r},refresh_grips_style:function(){var t=this,a=t.data("settings");if("undefined"!=typeof a.highlight){var e=t.data("highlightedRangeMin");if("undefined"!=typeof e){var r=t.find(a.left_grip_selector),i=t.find(a.right_grip_selector),n=t.data("highlightedRangeMax"),l=t.data("cur_min"),_=t.data("cur_max"),o=a.highlight.grip_class;e>l||l>n?r.removeClass(o):r.addClass(o),e>_||_>n?i.removeClass(o):i.addClass(o)}}},set_position_from_val:function(t,a){var e=this,r=e.data("range_min"),i=e.data("range_max");r>t&&(t=r),t>i&&(t=i),e.data("has_right_grip")?(a>i&&(a=i),r>a&&(a=r)):a=e.data("cur_max");var n=s.value_to_px.call(e,t),l=s.value_to_px.call(e,a);return d.set_handles_at_px.call(e,n,l),e.data("cur_min",t),e.data("has_right_grip")&&e.data("cur_max",a),e},set_position_from_px:function(t,a){var e=this;d.set_handles_at_px.call(e,t,a);var r=d.getSliderValuesAtPositionPx.call(e,t,a),i=r[0],n=r[1];return e.data("cur_min",i),e.data("has_right_grip")&&e.data("cur_max",n),e},set_handles_at_px:function(t,a){var e=this,r=e.data("settings"),i=r.left_grip_selector,n=r.right_grip_selector,l=r.value_bar_selector,_=e.data("left_grip_width"),o=_/2;return e.data("has_right_grip")?(e.find(l).css("left",t+o+"px").css("width",a-t+o+"px"),e.find(i).css("left",t+"px")):(a>t?e.find(l).css("left",t+o+"px").css("width",a-t+o+"px"):e.find(l).css("left",a+o+"px").css("width",t-a+o+"px"),e.find(i).css("left",t+"px")),e.find(n).css("left",a+"px"),e},drag_start_func_touch:function(t,a,e,i,n){var l=this,_=t.originalEvent,o=_.touches[0],s=o.pageY,u=o.pageX,c=Math.abs(l.offset().top-s),g=l.offset().left,f=g-u,h=u-(g+l.width());c>a.touch_tolerance_value_bar_y||f>a.touch_tolerance_value_bar_x||h>a.touch_tolerance_value_bar_x||(_.preventDefault(),r=o.pageX,d.drag_start_func.call(l,o,a,e,i,n))},drag_start_func:function(r,n,l,_,o){var u=this;if(u.find(n.left_grip_selector+","+n.value_bar_selector+","+n.right_grip_selector).removeClass(n.animating_css_class),s.is_enabled.call(u)){var c=t(r.target),g=!1;if("object"==typeof n.highlight&&(g=c.is(n.highlight.panel_selector)),o!==!1||c.is(n.left_grip_selector)||c.is(n.right_grip_selector)||c.is(n.value_bar_selector)||g||c.is(u)){a=u;var f,h,p,v,m,x,b=d.getGripPositionPx.call(u,l),y=d.getSliderWidthPx.call(u)-u.data("left_grip_width"),P=l.offset().left,w=d.getRightGripPositionPx.call(u);h=Math.round(r.pageX)-u.data("left_grip_width")/2,p=Math.abs(P-h),m=h-P,u.data("has_right_grip")?(f=_.offset().left,v=Math.abs(f-h),x=h-f):(v=2*p,x=2*m),n.user_drag_start_callback.call(u,r),p===v?P>h?(b+=m,i=!0):(w+=x,i=!1):v>p?(b+=m,i=!0):(w+=x,i=!1),u.data("has_right_grip")?w>y&&(w=y):b>y&&(b=y),0>b&&(b=0),e=!0;var S=u.data("cur_min"),G=u.data("cur_max");d.set_position_from_px.call(u,b,w),d.refresh_grips_style.call(u),d.notify_changed_implicit.call(u,"drag_start",S,G),"[object Touch]"!==Object.prototype.toString.apply(r)&&r.preventDefault()}}},drag_move_func_touch:function(t){if(e===!0){var a=t.originalEvent;a.preventDefault();var r=a.touches[0];d.drag_move_func(r)}},drag_move_func:function(t){if(e){var n=a,l=n.data("settings"),_=d.getSliderWidthPx.call(n)-n.data("left_grip_width"),o=d.getLeftGripPositionPx.call(n),s=d.getRightGripPositionPx.call(n),u=Math.round(t.pageX),c=u-r,g=n.data("left_grip_width")/2,f=n.offset().left+n.data("left_grip_width")-g,h=f+_;l.crossable_handles===!1&&n.data("has_right_grip")&&(i?h=f+s:f+=o);var p=0,v=0;f>u&&(p=1,v=0),u>h&&(v=1,p=0),l.crossable_handles===!0&&n.data("has_right_grip")&&(i?_>=s&&o+c>s&&(i=!1,o=s):o>=0&&o>s+c&&(i=!0,s=o));var m=o,x=s;(c>0&&!p||0>c&&!v)&&(i?m+=c:x+=c),d.validateAndMoveGripsToPx.call(n,m,x),r=u,"[object Touch]"!==Object.prototype.toString.apply(t)&&t.preventDefault()}},drag_end_func_touch:function(t){var a=t.originalEvent;a.preventDefault();var e=a.touches[0];d.drag_end_func(e)},drag_end_func:function(){var t=a;if("undefined"!=typeof t){e=!1,r=void 0,d.notify_mouse_up_implicit.call(t,i),a=void 0;var n=t.data("settings");t.find(n.left_grip_selector+","+n.value_bar_selector+","+n.right_grip_selector).addClass(n.animating_css_class)}},get_rounding_for_value:function(t){var a=this,e=a.data("rounding"),r=a.data("rounding_ranges");if("object"==typeof r){var i=d.binarySearch.call(a,r,t,function(t,a){return t[a].range},function(t,a,e){return t<a[e].range?e>0?t>=a[e-1].range?0:-1:0:1});if(e=1,i>-1)e=parseInt(r[i].value,10);else{var n=r.length-1;t>=r[n].range&&(e=r[n].value)}}return e},notify_mouse_up_implicit:function(t){var a=this,e=s.get_current_min_value.call(a),r=s.get_current_max_value.call(a),i=!1;(a.data("beforestart_min")!==e||a.data("beforestart_max")!==r)&&(i=!0,a.data("beforestart_min",e),a.data("beforestart_max",r));var n=a.data("settings");return n.user_mouseup_callback.call(a,s.get_current_min_value.call(a),s.get_current_max_value.call(a),t,i),a},notify_changed_implicit:function(t,a,e){var r=this,i=!1;("init"===t||"refresh"===t)&&(i=!0);var n=s.get_current_min_value.call(r),l=s.get_current_max_value.call(r);return i||(a=s.round_value_according_to_rounding.call(r,a),e=s.round_value_according_to_rounding.call(r,e)),(i||n!==a||l!==e)&&(d.notify_changed_explicit.call(r,t,a,e,n,l),i=1),i},notify_changed_explicit:function(t,a,e,r,i){var n=this,l=n.data("settings");return n.data("aria_enabled")&&d.updateAriaAttributes.call(n),l.value_changed_callback.call(n,t,r,i,a,e),n},validate_params:function(a){var e=this,r=e.data("range_min"),i=e.data("range_max"),n=e.data("cur_min"),l=e.data("lower-limit"),_=e.data("upper-limit"),o=d.haveLimits.call(e);"undefined"==typeof r&&t.error("the data-range_min attribute was not defined"),"undefined"==typeof i&&t.error("the data-range_max attribute was not defined"),"undefined"==typeof n&&t.error("the data-cur_min attribute must be defined"),r>i&&t.error("Invalid input parameter. must be min < max"),o&&l>_&&t.error("Invalid data-lower-limit or data-upper-limit"),0===e.find(a.left_grip_selector).length&&t.error("Cannot find element pointed by left_grip_selector: "+a.left_grip_selector),"undefined"!=typeof a.right_grip_selector&&0===e.find(a.right_grip_selector).length&&t.error("Cannot find element pointed by right_grip_selector: "+a.right_grip_selector),"undefined"!=typeof a.value_bar_selector&&0===e.find(a.value_bar_selector).length&&t.error("Cannot find element pointed by value_bar_selector"+a.value_bar_selector)},rangemap_0_to_n:function(t,a){var e=this,r=e.data("range_min"),i=e.data("range_max");return r>=t?0:t>=i?a:Math.floor((a*t-a*r)/(i-r))},inverse_rangemap_0_to_n:function(t,a){var e=this,r=e.data("range_min"),i=e.data("range_max");if(0>=t)return r;if(t>=a)return i;var n=(i-r)*t/a;return n+r}},s={teardown:function(){var a=this;return a.removeData(),t(document).unbind("mousemove.nstSlider").unbind("mouseup.nstSlider"),a.parent().unbind("mousedown.nstSlider").unbind("touchstart.nstSlider").unbind("touchmove.nstSlider").unbind("touchend.nstSlider"),a.unbind("keydown.nstSlider").unbind("keyup.nstSlider"),a},init:function(a){var e=t.extend({animating_css_class:"nst-animating",touch_tolerance_value_bar_y:30,touch_tolerance_value_bar_x:15,left_grip_selector:".nst-slider-grip-left",right_grip_selector:void 0,highlight:void 0,rounding:void 0,value_bar_selector:void 0,crossable_handles:!0,value_changed_callback:function(){},user_mouseup_callback:function(){},user_drag_start_callback:function(){}},a),r=t(document);return r.unbind("mouseup.nstSlider"),r.unbind("mousemove.nstSlider"),r.bind("mousemove.nstSlider",d.drag_move_func),r.bind("mouseup.nstSlider",d.drag_end_func),this.each(function(){var a=t(this),r=a.parent();a.data("enabled",!0);var u=a.data("range_min"),c=a.data("range_max"),g=a.data("cur_min"),f=a.data("cur_max");"undefined"==typeof f&&(f=g),""===u&&(u=0),""===c&&(c=0),""===g&&(g=0),""===f&&(f=0),a.data("range_min",u),a.data("range_max",c),a.data("cur_min",g),a.data("cur_max",f),d.validate_params.call(a,e),a.data("settings",e),"undefined"!=typeof e.rounding?s.set_rounding.call(a,e.rounding):"undefined"!=typeof a.data("rounding")?s.set_rounding.call(a,a.data("rounding")):s.set_rounding.call(a,1);var h=a.find(e.left_grip_selector)[0],p=t(h),v=t(a.find(e.right_grip_selector)[0]);"undefined"==typeof p.attr("tabindex")&&p.attr("tabindex",0);var m=!1;a.find(e.right_grip_selector).length>0&&(m=!0,"undefined"==typeof v.attr("tabindex")&&v.attr("tabindex",0)),a.data("has_right_grip",m),a.data("aria_enabled")===!0&&(p.attr("role","slider").attr("aria-disabled","false"),m&&v.attr("role","slider").attr("aria-disabled","false")),a.bind("keyup.nstSlider",function(t){if(a.data("enabled")){switch(t.which){case 37:case 38:case 39:case 40:if(n===_){var e,r,u,c=d.getSliderWidthPx.call(a);if(0>l-o){for(r=o;c>=r;r++)if(e=s.round_value_according_to_rounding.call(a,d.getSliderValuesAtPositionPx.call(a,r,r)[1]),e!==_){u=r;break}}else for(r=o;r>=0;r--)if(e=s.round_value_according_to_rounding.call(a,d.getSliderValuesAtPositionPx.call(a,r,r)[1]),e!==_){u=r;break}i?d.validateAndMoveGripsToPx.call(a,u,d.getRightGripPositionPx.call(a)):d.validateAndMoveGripsToPx.call(a,d.getLeftGripPositionPx.call(a),u),d.notify_mouse_up_implicit.call(a,i)}}n=void 0,l=void 0,_=void 0,o=void 0}}),a.bind("keydown.nstSlider",function(t){if(a.data("enabled")){var e=function(t,e){var r=d.getLeftGripPositionPx.call(a),u=d.getRightGripPositionPx.call(a);switch("undefined"==typeof n&&(l=i?r:u,n=i?s.get_current_min_value.call(a):s.get_current_max_value.call(a)),e.which){case 37:case 40:i?r--:u--,e.preventDefault();break;case 38:case 39:i?r++:u++,e.preventDefault()}o=i?r:u,d.validateAndMoveGripsToPx.call(a,r,u),_=i?s.get_current_min_value.call(a):s.get_current_max_value.call(a)};m&&a.find(":focus").is(v)?(i=!1,e.call(a,v,t)):(i=!0,e.call(a,p,t))}});var x=d.getLeftGripWidth.call(a),b=m?d.getRightGripWidth.call(a):x;a.data("left_grip_width",x),a.data("right_grip_width",b),a.data("value_bar_selector",e.value_bar_selector),u===c||g===f?s.set_range.call(a,u,c):d.set_position_from_val.call(a,a.data("cur_min"),a.data("cur_max")),d.notify_changed_implicit.call(a,"init"),a.data("beforestart_min",s.get_current_min_value.call(a)),a.data("beforestart_max",s.get_current_max_value.call(a)),a.bind("mousedown.nstSlider",function(t){d.drag_start_func.call(a,t,e,p,v,!1)}),r.bind("touchstart.nstSlider",function(t){d.drag_start_func_touch.call(a,t,e,p,v,!0)}),r.bind("touchend.nstSlider",function(t){d.drag_end_func_touch.call(a,t)}),r.bind("touchmove.nstSlider",function(t){d.drag_move_func_touch.call(a,t)});var y=a.data("histogram");"undefined"!=typeof y&&s.set_step_histogram.call(a,y)})},get_range_min:function(){var t=this;return t.data("range_min")},get_range_max:function(){var t=this;return t.data("range_max")},get_current_min_value:function(){var a,e=t(this),r=s.get_range_min.call(e),i=s.get_range_max.call(e),n=e.data("cur_min");if(a=r>=n?r:s.round_value_according_to_rounding.call(e,n),d.haveLimits.call(e)){if(r>=a)return e.data("lower-limit");if(a>=i)return e.data("upper-limit")}else{if(r>=a)return r;if(a>=i)return i}return a},get_current_max_value:function(){var a,e=t(this),r=s.get_range_min.call(e),i=s.get_range_max.call(e),n=e.data("cur_max");if(a=n>=i?i:s.round_value_according_to_rounding.call(e,n),d.haveLimits.call(e)){if(a>=i)return e.data("upper-limit");if(r>=a)return e.data("lower-limit")}else{if(a>=i)return i;if(r>=a)return r}return a},is_handle_to_left_extreme:function(){var t=this;return d.haveLimits.call(t)?t.data("lower-limit")===s.get_current_min_value.call(t):s.get_range_min.call(t)===s.get_current_min_value.call(t)},is_handle_to_right_extreme:function(){var t=this;return d.haveLimits.call(t)?t.data("upper-limit")===s.get_current_max_value.call(t):s.get_range_max.call(t)===s.get_current_max_value.call(t)},refresh:function(){var t=this,a=t.data("last_step_histogram");"undefined"!=typeof a&&s.set_step_histogram.call(t,a),d.set_position_from_val.call(t,s.get_current_min_value.call(t),s.get_current_max_value.call(t));var e=t.data("highlightedRangeMin");if("number"==typeof e){var r=t.data("highlightedRangeMax");s.highlight_range.call(t,e,r)}return d.notify_changed_implicit.call(t,"refresh"),t},disable:function(){var t=this,a=t.data("settings");return t.data("enabled",!1).find(a.left_grip_selector).attr("aria-disabled","true").end().find(a.right_grip_selector).attr("aria-disabled","true"),t},enable:function(){var t=this,a=t.data("settings");return t.data("enabled",!0).find(a.left_grip_selector).attr("aria-disabled","false").end().find(a.right_grip_selector).attr("aria-disabled","false"),t},is_enabled:function(){var t=this;return t.data("enabled")},set_position:function(t,a){var e=this,r=e.data("cur_min"),i=e.data("cur_max");t>a?d.set_position_from_val.call(e,a,t):d.set_position_from_val.call(e,t,a),d.refresh_grips_style.call(e),d.notify_changed_implicit.call(e,"set_position",r,i),e.data("beforestart_min",t),e.data("beforestart_max",a)},set_step_histogram:function(a){var e=this;e.data("last_step_histogram",a),"undefined"==typeof a&&(t.error("got an undefined histogram in set_step_histogram"),d.unset_step_histogram.call(e));var r=d.getSliderWidthPx.call(e)-e.data("left_grip_width"),i=a.length;if(!(0>=r)){var n,l=0;for(n=0;i>n;n++)l+=a[n];if(0===l)return s.unset_step_histogram.call(e),e;var _=parseFloat(l)/r;for(n=0;i>n;n++)a[n]=a[n]/_;var o=[a[0]];for(n=1;i>n;n++){var u=o[n-1]+a[n];o.push(u)}o.push(r);for(var c=[e.data("range_min")],g=0,f=c[0],h=0;r>=g;){var p=parseInt(o.shift(),10),v=d.inverse_rangemap_0_to_n.call(e,h+1,i+1);h++;var m=p-g,x=v-f;for(n=g;p>n;n++){var b=f+x*(n-g+1)/m;c.push(b),g++,f=b}if(g===r)break}c[c.length-1]=e.data("range_max");var y=function(t){return c[parseInt(t,10)]},P=function(t){var a=d.binarySearch.call(e,c,t,function(t,a){return t[a]},d.binarySearchValueToPxCompareFunc);return c[a]===t?a:Math.abs(c[a-1]-t)<Math.abs(c[a]-t)?a-1:a};return e.data("pixel_to_value_mapping",y),e.data("value_to_pixel_mapping",P),e}},unset_step_histogram:function(){var t=this;return t.removeData("pixel_to_value_mapping"),t.removeData("value_to_pixel_mapping"),t.removeData("last_step_histogram"),t},set_range:function(t,a){var e=this,r=s.get_current_min_value.call(e),i=s.get_current_max_value.call(e);return e.data("range_min",t),e.data("range_max",a),d.set_position_from_val.call(e,r,i),d.notify_changed_implicit.call(e,"set_range",r,i),e},highlight_range:function(a,e){var r=this,i=r.data("settings");"undefined"==typeof i.highlight&&t.error('you cannot call highlight_range if you haven\' specified the "highlight" parameter in construction!'),a||(a=0),e||(e=0);var n=s.value_to_px.call(r,a),l=s.value_to_px.call(r,e),_=l-n+r.data("left_grip_width"),o=r.find(i.highlight.panel_selector);return o.css("left",n+"px"),o.css("width",_+"px"),r.data("highlightedRangeMin",a),r.data("highlightedRangeMax",e),d.refresh_grips_style.call(r),r},set_rounding:function(a){var e=this;"string"==typeof a&&a.indexOf("{")>-1&&(a=t.parseJSON(a)),e.data("rounding",a);var r=[];if("object"==typeof a){var i;for(i in a)if(a.hasOwnProperty(i)){var n=a[i];r.push({range:n,value:i})}r.sort(function(t,a){return t.range-a.range}),e.data("rounding_ranges",r)}else e.removeData("rounding_ranges");return e},get_rounding:function(){var t=this;return t.data("rounding")},round_value_according_to_rounding:function(a){var e=this,r=d.get_rounding_for_value.call(e,a);if(r>0){var i=a/r,n=parseInt(i,10),l=i-n;l>.5&&n++;var _=n*r;return _}return t.error("rounding must be > 0, got "+r+" instead"),a},value_to_px:function(t){var a=this,e=a.data("value_to_pixel_mapping");if("undefined"!=typeof e)return e(t);var r=d.getSliderWidthPx.call(a)-a.data("left_grip_width");return d.rangemap_0_to_n.call(a,t,r)}},u="nstSlider";t.fn[u]=function(a){if(s[a]){if(this.data("initialized")===!0)return s[a].apply(this,Array.prototype.slice.call(arguments,1));throw new Error("method "+a+" called on an uninitialized instance of "+u)}return"object"!=typeof a&&a?void t.error("Cannot call method "+a):(this.data("initialized",!0),s.init.apply(this,arguments))}}(jQuery);